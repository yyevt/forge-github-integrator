modules:
  jira:adminPage:
    - key: forge-github-integrator-admin-page
      title: Forge GitHub Integrator
      resource: appPage
      render: native
      resolver:
        function: resolveApi

  webtrigger:
    - key: github-merge-events-webtrigger
      function: handleGithubEvents
      response:
        type: dynamic

  consumer:
    - key: github-merge-events-consumer
      queue: merge-events-queue
      function: listenQueueEvents

  function:
    - key: resolveApi
      handler: index.apiResolver
    - key: handleGithubEvents
      handler: index.githubWebhookHandler
    - key: listenQueueEvents
      handler: index.queueListener

resources:
  - key: appPage
    path: src/frontend/index.tsx

permissions:
  scopes:
    - storage:app
    - read:jira-work
    - write:jira-work
  external:
    fetch:
      backend:
        - address: https://api.github.com

environment:
  variables:
    - key: FETCH_REPOS_LIMIT
      default: "100"
    - key: FETCH_LANGUAGES_LIMIT
      default: "100"
    - key: FETCH_PRS_LIMIT
      default: "100"

app:
  runtime:
    name: nodejs22.x
    memoryMB: 256
    architecture: arm64
  id: ari:cloud:ecosystem::app/6f2b818a-c927-4cf1-a438-2361c7a80f49
